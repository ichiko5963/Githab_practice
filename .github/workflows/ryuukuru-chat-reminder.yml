name: ã‚Šã‚…ã†ã‚¯ãƒ«é›‘è«‡ãƒãƒ£ãƒ³ãƒãƒ«ãƒªãƒã‚¤ãƒ³ãƒ‰

on:
  schedule:
    # æ¯æ—¥ 20:00 JST = 11:00 UTC
    - cron: '0 11 * * *'
  workflow_dispatch: # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½

jobs:
  check-chat-channel:
    runs-on: ubuntu-latest
    
    steps:
      - name: ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4
        
      - name: Node.jsã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
          
      - name: ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        run: npm ci
        
      - name: ã‚Šã‚…ã†ã‚¯ãƒ«é›‘è«‡ãƒãƒ£ãƒ³ãƒãƒ«ãƒã‚§ãƒƒã‚¯ï¼†ãƒªãƒã‚¤ãƒ³ãƒ‰
        env:
          SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
          SLACK_ZATSUDAN_CHANNEL_ID: ${{ secrets.SLACK_ZATSUDAN_CHANNEL_ID }}
          SLACK_KEIEI_CHANNEL_ID: ${{ secrets.SLACK_KEIEI_CHANNEL_ID }}
          TZ: Asia/Tokyo
        run: node scripts/ryuukuru-chat-reminder.js
        
      - name: å®Ÿè¡Œçµæœã‚’ãƒ­ã‚°å‡ºåŠ›
        if: always()
        run: |
          echo "âœ… ã‚Šã‚…ã†ã‚¯ãƒ«é›‘è«‡ãƒãƒ£ãƒ³ãƒãƒ«ãƒã‚§ãƒƒã‚¯ã®å®Ÿè¡ŒãŒå®Œäº†ã—ã¾ã—ãŸ"
          echo "ğŸ“… å®Ÿè¡Œæ™‚åˆ»: $(date '+%Y-%m-%d %H:%M:%S JST')"
