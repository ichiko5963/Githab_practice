name: ãƒªãƒ¥ãƒ¼ã‚¯ãƒ«é€±ä¾‹ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒã‚¤ãƒ³ãƒ‰

on:
  schedule:
    # æ¯é€±æ°´æ›œæ—¥ 15:00 (JST) = 06:00 UTC
    - cron: '0 6 * * 3'
    # æ¯é€±æœ¨æ›œæ—¥ 15:00 (JST) = 06:00 UTC  
    - cron: '0 6 * * 4'
  workflow_dispatch: # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½

jobs:
  send-weekly-meeting-reminder:
    runs-on: ubuntu-latest
    
    steps:
      - name: ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4
        
      - name: Node.jsã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        run: npm ci
        
      - name: ãƒªãƒ¥ãƒ¼ã‚¯ãƒ«é€±ä¾‹ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒã‚¤ãƒ³ãƒ‰ã‚’é€ä¿¡
        env:
          SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
        run: node scripts/ryuukuru-weekly-meeting-reminder.js
        
      - name: å®Ÿè¡Œçµæœã‚’ãƒ­ã‚°å‡ºåŠ›
        if: always()
        run: |
          echo "âœ… ãƒªãƒ¥ãƒ¼ã‚¯ãƒ«é€±ä¾‹ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒã‚¤ãƒ³ãƒ‰ã®å®Ÿè¡ŒãŒå®Œäº†ã—ã¾ã—ãŸ"
          echo "ğŸ“… å®Ÿè¡Œæ™‚åˆ»: $(date '+%Y-%m-%d %H:%M:%S JST')"
